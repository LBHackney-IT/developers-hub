{"ast":null,"code":"import _defineProperty from\"/Users/lbasiu/Documents/Repos/developers-hub-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/lbasiu/Documents/Repos/developers-hub-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/lbasiu/Documents/Repos/developers-hub-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/lbasiu/Documents/Repos/developers-hub-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/lbasiu/Documents/Repos/developers-hub-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from\"react\";import FormInput from\"../../components/form-input/form-input.component.jsx\";import UserContext from\"../../context/user.context.js\";import Button from\"../../components/button/button.component.jsx\";import{withRouter}from\"react-router-dom\";import APP_PATHS from\"../../APP_PATHS.js\";import{SOCKET_ADDRESS}from\"../../APP_CONFIG.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginPage=function LoginPage(_ref){var history=_ref.history,user=_ref.currentUser;if(user)history.push(APP_PATHS.home);var _useState=useState({email:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];function postData(){return _postData.apply(this,arguments);}function _postData(){_postData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var url,data,response,responseData,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:url=_args2.length>0&&_args2[0]!==undefined?_args2[0]:'';data=_args2.length>1&&_args2[1]!==undefined?_args2[1]:{};_context2.next=4;return fetch(url,{method:'POST',// *GET, POST, PUT, DELETE, etc.\nheaders:{'Content-Type':'application/x-www-form-urlencoded'},body:data// body data type must match \"Content-Type\" header\n});case 4:response=_context2.sent;_context2.next=7;return response.text();case 7:responseData=_context2.sent;return _context2.abrupt(\"return\",responseData);case 9:case\"end\":return _context2.stop();}}},_callee2);}));return _postData.apply(this,arguments);}var _useState3=useState(user),_useState4=_slicedToArray(_useState3,2),currentUser=_useState4[0],setCurrentUser=_useState4[1];var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var emailInput,passwordInput,jsonData,formatData,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();emailInput=document.querySelector(\"#login-email\");passwordInput=document.querySelector(\"#login-pass\");jsonData={email:emailInput.value,password:passwordInput.value};formatData=new URLSearchParams(Object.entries(jsonData));_context.next=7;return postData(\"\".concat(SOCKET_ADDRESS).concat(APP_PATHS.login),formatData.toString());case 7:data=_context.sent;console.log(data);if(data!==\"{}\"){// set user here\nhistory.push(APP_PATHS.home);}else{alert(\"Login failed!\");}case 10:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var handleInput=function handleInput(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},name,value)));};return/*#__PURE__*/_jsxs(\"div\",{id:\"login-page\",className:\"page\",children:[/*#__PURE__*/_jsxs(\"form\",{id:\"login-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(FormInput,{id:\"login-email\",type:\"email\",name:\"email\",value:formData.email,label:\"Email\",required:true,onChange:handleInput}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(FormInput,{id:\"login-pass\",type:\"password\",name:\"password\",value:formData.password,label:\"Password\",required:true,onChange:handleInput}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{type:\"submit\",children:\"Submit\"})]}),/*#__PURE__*/_jsx(\"a\",{href:\"https://auth.hackney.gov.uk/auth?redirect_uri=http://localhost:3000/register\",role:\"button\",draggable:\"false\",class:\"govuk-button lbh-button\",\"data-module\":\"govuk-button\",children:\"Google sign in\"})]});};export default withRouter(LoginPage);","map":{"version":3,"sources":["/Users/lbasiu/Documents/Repos/developers-hub-frontend/src/pages/login/login.page.jsx"],"names":["React","useState","useContext","FormInput","UserContext","Button","withRouter","APP_PATHS","SOCKET_ADDRESS","LoginPage","history","user","currentUser","push","home","email","password","formData","setFormData","postData","url","data","fetch","method","headers","body","response","text","responseData","setCurrentUser","handleSubmit","event","preventDefault","emailInput","document","querySelector","passwordInput","jsonData","value","formatData","URLSearchParams","Object","entries","login","toString","console","log","alert","handleInput","target","name"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from \"react\";\nimport FormInput from \"../../components/form-input/form-input.component.jsx\";\nimport UserContext from \"../../context/user.context.js\";\nimport Button from \"../../components/button/button.component.jsx\";\nimport { withRouter } from \"react-router-dom\";\nimport APP_PATHS from \"../../APP_PATHS.js\";\nimport { SOCKET_ADDRESS } from \"../../APP_CONFIG.js\";\n\nconst LoginPage = ({ history, currentUser: user }) => {\n  if (user) history.push(APP_PATHS.home);\n\n  const [formData, setFormData] = useState({\n    email: \"\",\n    password: \"\"\n  });\n\n  async function postData(url = '', data = {}) {\n    // Default options are marked with *\n    const response = await fetch(url, {\n      method: 'POST', // *GET, POST, PUT, DELETE, etc.\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      body: data // body data type must match \"Content-Type\" header\n    });\n    const responseData = await response.text(); // parses JSON response into native JavaScript objects\n    return responseData;\n  }\n\n  const [currentUser, setCurrentUser] = useState(user);\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n\n    const emailInput = document.querySelector(\"#login-email\");\n    const passwordInput = document.querySelector(\"#login-pass\");\n\n    const jsonData = {email: emailInput.value, password: passwordInput.value};\n\n    const formatData = new URLSearchParams(Object.entries(jsonData));\n\n    const data = await postData(`${SOCKET_ADDRESS}${APP_PATHS.login}`, formatData.toString());\n    console.log(data);\n    if (data !== \"{}\") {\n      // set user here\n      history.push(APP_PATHS.home);\n    } else {\n      alert(\"Login failed!\");\n    }\n  };\n\n  const handleInput = (event) => {\n    const { name, value } = event.target;\n\n    setFormData({\n      ...formData,\n      [name]: value\n    });\n  };\n\n  return (\n    <div id=\"login-page\" className=\"page\">\n      <form\n        id=\"login-form\"\n        onSubmit={handleSubmit}>\n        <FormInput\n          id=\"login-email\"\n          type=\"email\"\n          name=\"email\"\n          value={formData.email}\n          label=\"Email\"\n          required\n          onChange={handleInput} />\n        <br/>\n        <FormInput\n          id=\"login-pass\"\n          type=\"password\"\n          name=\"password\"\n          value={formData.password}\n          label=\"Password\"\n          required\n          onChange={handleInput} />\n        <br />\n        <Button type=\"submit\">Submit</Button>\n      </form>\n      <a\n        href=\"https://auth.hackney.gov.uk/auth?redirect_uri=http://localhost:3000/register\"\n        role=\"button\"\n        draggable=\"false\"\n        class=\"govuk-button lbh-button\"\n        data-module=\"govuk-button\"\n        >\n        Google sign in\n        </a>\n    </div>\n\n\n\n\n\n  );\n};\n\nexport default withRouter(LoginPage);\n"]},"metadata":{},"sourceType":"module"}